#include <Arduino.h>
#include "LEDMatrix.h"

#define WIDTH   16
#define HEIGHT  16

//     LEDMatrix(a, b, c, d, oe, r1, stb, clk);
LEDMatrix matrix(4, 5, 6, 7, 8, 9, 10, 11);

// Display Buffer 128 = 64 * 16 / 8
uint8_t displaybuf[WIDTH * HEIGHT / 8];

uint8_t arrows[] = {
		0x00, 0x10, 0x00, 0x38, 0x00, 0x7c, 0x00, 0xfe, 0x00, 0x38, 0x00, 0x38, 0x00, 0x38, 0x00, 0x00,     // UP
		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,

		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
		0x00, 0x38, 0x00, 0x38, 0x00, 0x38, 0x00, 0xfe, 0x00, 0x7c, 0x00, 0x38, 0x00, 0x10, 0x00, 0x00,     // DOWN

		0x00, 0x10, 0x00, 0x30, 0x00, 0x7e, 0x00, 0xfe, 0x00, 0x7e, 0x00, 0x30, 0x00, 0x10, 0x00, 0x00,     // RIGHT
		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,

		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
		0x00, 0x10, 0x00, 0x18, 0x00, 0xfc, 0x00, 0xfe, 0x00, 0xfc, 0x00, 0x18, 0x00, 0x10, 0x00, 0x00,     // LEFT

};


void setup() {
	matrix.begin(displaybuf, WIDTH, HEIGHT);
	matrix.clear();
}

void loop() {
	static unsigned long lastCountTime = 0;
	static int count = 0;

	matrix.scan();

	if ((millis() - lastCountTime) > 1000) {
		lastCountTime = millis();
		matrix.clear();
		matrix.drawImage(0, 0, WIDTH, HEIGHT, arrows + (count * (WIDTH + HEIGHT)));
		count = (count + 1) % 4;
	}
}

